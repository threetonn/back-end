"use strict";(self["webpackChunktriton"]=self["webpackChunktriton"]||[]).push([[4336,6030],{6030:function(s,t,e){function a(s,t,e,a){let i=Math.abs(s);return i%=100,i>=5&&i<=20?a:(i%=10,1===i?t:i>=2&&i<=4?e:a)}e.r(t),e.d(t,{getNoun:function(){return a}})},4336:function(s,t,e){e.r(t),e.d(t,{default:function(){return H}});var a=e(3396),i=e(7139),r=e(9242);const n={class:"subscription-card__text-block"},u={class:"subscription-card__title"},c={class:"subscription-card__price-month"},o={class:"price"},l=(0,a._)("span",null,"руб./день",-1),p=(0,a._)("p",{class:"subscription-card__price-year--description"}," При оплате за год: ",-1),d={class:"subscription-card__price-year"},b={class:"price"},_=(0,a._)("span",null,"руб./за",-1),D={class:"days"},w={class:"discount"},v={class:"subscription-card__list"},g=(0,a._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,a._)("path",{d:"M4 12L10 18L20 6",stroke:"black","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),y={class:"subscription-card__sub-date"},h=(0,a._)("span",null,"Начало: ",-1),k={class:"error-msg"},m={class:"error-msg"},$=["disabled"];function f(s,t,e,f,S,z){return(0,a.wg)(),(0,a.iD)("div",{class:(0,i.C_)(["subscription-card",`subscription-card--${e.subscription.type}`])},[(0,a._)("div",null,[(0,a._)("div",n,[(0,a._)("p",u,(0,i.zw)(e.subscription.title),1),(0,a._)("p",c,[(0,a._)("span",o,(0,i.zw)(e.subscription.price),1),l]),(0,a._)("div",null,[p,(0,a._)("p",d,[(0,a._)("span",b,(0,i.zw)(f.subscriptioDiscountCalculation(e.subscription.price*f.state.subscriptionDays)),1),_,(0,a._)("span",D,(0,i.zw)(f.state.subscriptionDays),1),(0,a._)("span",null,(0,i.zw)(f.getNoun(f.state.subscriptionDays,"день","дня","дней")),1)]),(0,a._)("p",w,[(0,a.Uk)(" Скидка: "),(0,a._)("span",null,(0,i.zw)((100*f.computedDiscount).toFixed(2))+"%",1)])])]),(0,a._)("ul",v,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.subscription.features,((s,t)=>((0,a.wg)(),(0,a.iD)("li",{class:"subscription-card__list-item",key:t},[g,(0,a._)("span",null,(0,i.zw)(s),1)])))),128))])]),(0,a._)("div",null,[(0,a._)("div",y,[(0,a._)("div",null,[(0,a._)("div",{class:(0,i.C_)(["lf-inputs__wrapper",{error:f.v$.subStartDate.$errors.length}])},[h,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>f.state.subStartDate=s),class:"subscription-card__date-input",type:"date"},null,512),[[r.nr,f.state.subStartDate]]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.v$.subStartDate.$errors,(s=>((0,a.wg)(),(0,a.iD)("div",{class:"input-errors",key:s.$uid},[(0,a._)("div",k,(0,i.zw)(s.$message),1)])))),128))],2)]),(0,a._)("p",null,"Конец: "+(0,i.zw)(f.endDate.toLocaleDateString()),1)]),(0,a._)("div",{class:(0,i.C_)(["lf-inputs__wrapper",{error:f.v$.subscriptionDays.$errors.length}])},[(0,a.wy)((0,a._)("input",{class:"subscription-card__days-input",type:"number",name:"sub-data",autocomplete:"off",placeholder:"Дни абонемента","onUpdate:modelValue":t[1]||(t[1]=s=>f.state.subscriptionDays=s)},null,512),[[r.nr,f.state.subscriptionDays,void 0,{number:!0}]]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.v$.subscriptionDays.$errors,(s=>((0,a.wg)(),(0,a.iD)("div",{class:"input-errors",key:s.$uid},[(0,a._)("div",m,(0,i.zw)(s.$message),1)])))),128))],2),(0,a._)("button",{onClick:t[2]||(t[2]=s=>f.activateSubscription(e.subscription.id)),class:(0,i.C_)(["subscription-card__button",f.isValid&&"disabled"]),disabled:f.isValid}," Активировать ",10,$)])],2)}var S=e(4870),z=e(6030),C=e(3053),M=e(9117),V={props:{subscription:Object,callback:Function},setup(s){const t=(0,S.qj)({subscriptionDays:1,subStartDate:null}),e=(0,a.Fl)((()=>t.subscriptionDays*s.subscription.discount/100)),i=s=>Math.round(s-s*e.value),r=(0,S.iH)(!1),n=new Date,u=(0,S.iH)(new Date((new Date).setDate((new Date).getDate()+t.subscriptionDays))),c=s=>new Date((new Date).setDate((new Date).getDate()+30))>=new Date(s)&&new Date(s)>=new Date,o=(0,a.Fl)((()=>({subscriptionDays:{required:M.helpers.withMessage("Поле обязательно для заполнения",M.required),between:M.helpers.withMessage("Абонемент не может быть меньше 1 и больше 365 дней",(0,M.between)(1,365))},subStartDate:{required:M.helpers.withMessage("Необходимо выбрать дату!",M.required),maxDateValidator:M.helpers.withMessage("Максимально отложить дату можно на 30 дней!",c)}}))),l=(0,C.Xw)(o,t),p=()=>(l.value.$touch(),l.value.$errors.length?(r.value=!0,console.log("Невалидно")):(r.value=!1,console.log("Валидно")));(0,a.YP)((()=>[t.subscriptionDays,t.subStartDate]),(()=>{p(),u.value=new Date(new Date(t.subStartDate).setDate(new Date(t.subStartDate).getDate()+t.subscriptionDays))}));const d=e=>{p();const a={id:e,start_date:t.subStartDate,day_count:t.subscriptionDays};!r.value&&s.callback(a)};return{state:t,v$:l,getNoun:z.getNoun,currentDate:n,endDate:u,isValid:r,subscriptioDiscountCalculation:i,computedDiscount:e,activateSubscription:d}}},q=e(89);const x=(0,q.Z)(V,[["render",f]]);var H=x}}]);
//# sourceMappingURL=4336.56d3de84.js.map