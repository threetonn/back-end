"use strict";(self["webpackChunktriton"]=self["webpackChunktriton"]||[]).push([[7181],{7181:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var r=a(3396),n=a(7139),s=a(9242);const i={class:"profile-page__add-train-form"},l={class:"error-msg"},o=(0,r._)("label",{class:"shedule-label",for:"trainStart"},"Начало тренировки: ",-1),u={class:"error-msg"},d=(0,r._)("label",{class:"shedule-label",for:"trainDuration"},"Длительность тренировки (мин.): ",-1),c={class:"error-msg"},p={class:"lf-inputs__wrapper"},v=(0,r._)("label",{class:"shedule-label",for:"trainEnd"},"Конец тренировки",-1),m={class:"shedule-p"},w={key:0,class:"lf-inputs__wrapper"},g={class:"shedule-select"},_=(0,r._)("label",{for:"user-select"},"Клиенты",-1),D={class:"custom-select"},h=(0,r._)("option",{disabled:"",value:""},"Выберите один из вариантов",-1),y=["selected","value"],f={key:1,class:"lf-inputs__wrapper"},S={class:"shedule-select"},k=(0,r._)("label",{for:"trainer-select"},"Тренер",-1),b={class:"custom-select"},N=(0,r._)("option",{disabled:"",value:""},"Выберите один из вариантов",-1),$=["selected","value"],T={class:"shedule-select"},I=(0,r._)("label",{for:"location-select"},"Местоположение",-1),F={class:"custom-select"},L=(0,r._)("option",{disabled:"",value:""},"Выберите один из вариантов",-1),U=["selected","value"],V={class:"error-msg"},M={key:2,class:"lf-inputs__wrapper"},q={class:"shedule-select"},z=(0,r._)("label",{for:"type-select"},"Тип тренировки",-1),C={class:"custom-select"},E=(0,r._)("option",{disabled:"",value:""},"Выберите один из вариантов",-1),H=["selected","value"],K=["disabled"];function O(e,t,a,O,Y,x){return(0,r.wg)(),(0,r.iD)("div",i,[(0,r._)("div",{class:(0,n.C_)(["lf-inputs__wrapper",{error:O.v$.trainName.$errors.length}])},[(0,r.wy)((0,r._)("input",{class:"lf-inputs__input",type:"text",name:"trainName",id:"trainName",placeholder:"Название тренировки","onUpdate:modelValue":t[0]||(t[0]=e=>O.state.trainName=e)},null,512),[[s.nr,O.state.trainName]]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(O.v$.trainName.$errors,(e=>((0,r.wg)(),(0,r.iD)("div",{class:"input-errors",key:e.$uid},[(0,r._)("div",l,(0,n.zw)(e.$message),1)])))),128))],2),(0,r._)("div",{class:(0,n.C_)(["lf-inputs__wrapper",{error:O.v$.trainStart.$errors.length}])},[o,(0,r.wy)((0,r._)("input",{class:"lf-inputs__input date-input",type:"datetime-local",name:"trainStart",id:"trainStart",placeholder:"Начало тренировки","onUpdate:modelValue":t[1]||(t[1]=e=>O.state.trainStart=e)},null,512),[[s.nr,O.state.trainStart]]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(O.v$.trainStart.$errors,(e=>((0,r.wg)(),(0,r.iD)("div",{class:"input-errors",key:e.$uid},[(0,r._)("div",u,(0,n.zw)(e.$message),1)])))),128))],2),(0,r._)("div",{class:(0,n.C_)(["lf-inputs__wrapper",{error:O.v$.trainDuration.$errors.length}])},[d,(0,r.wy)((0,r._)("input",{class:"lf-inputs__input",type:"number",name:"trainDuration",id:"trainDuration",placeholder:"Длительность тренировки","onUpdate:modelValue":t[2]||(t[2]=e=>O.state.trainDuration=e)},null,512),[[s.nr,O.state.trainDuration]]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(O.v$.trainDuration.$errors,(e=>((0,r.wg)(),(0,r.iD)("div",{class:"input-errors",key:e.$uid},[(0,r._)("div",c,(0,n.zw)(e.$message),1)])))),128))],2),(0,r._)("div",p,[v,(0,r._)("p",m,(0,n.zw)(""!==O.endDate?O.endDate.toLocaleString():"-"),1)]),"trainer"===O.user.role?((0,r.wg)(),(0,r.iD)("div",w,[(0,r._)("div",g,[_,(0,r._)("div",D,[(0,r.wy)((0,r._)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>O.state.selectUser=e),id:"user-select"},[h,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(O.clients,(e=>((0,r.wg)(),(0,r.iD)("option",{selected:e.id===O.state.selectUser,key:e.id,value:e.id},(0,n.zw)(e.name),9,y)))),128))],512),[[s.bM,O.state.selectUser]])])])])):(0,r.kq)("",!0),"manager"===O.user.role?((0,r.wg)(),(0,r.iD)("div",f,[(0,r._)("div",S,[k,(0,r._)("div",b,[(0,r.wy)((0,r._)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>O.state.trainer=e),id:"trainer-select"},[N,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(O.trainersList,(e=>((0,r.wg)(),(0,r.iD)("option",{selected:e.email===O.state.trainer,key:e.email,value:e.email},(0,n.zw)(e.name),9,$)))),128))],512),[[s.bM,O.state.trainer]])])])])):(0,r.kq)("",!0),(0,r._)("div",{class:(0,n.C_)(["lf-inputs__wrapper",{error:O.v$.trainLocation.$errors.length}])},[(0,r._)("div",T,[I,(0,r._)("div",F,[(0,r.wy)((0,r._)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>O.state.trainLocation=e),id:"location-select"},[L,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(O.workoutLocations,(e=>((0,r.wg)(),(0,r.iD)("option",{selected:e.name===O.state.trainLocation,key:e.name,value:e.name},(0,n.zw)(e.address),9,U)))),128))],512),[[s.bM,O.state.trainLocation]])])]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(O.v$.trainLocation.$errors,(e=>((0,r.wg)(),(0,r.iD)("div",{class:"input-errors",key:e.$uid},[(0,r._)("div",V,(0,n.zw)(e.$message),1)])))),128))],2),"manager"===O.user.role?((0,r.wg)(),(0,r.iD)("div",M,[(0,r._)("div",q,[z,(0,r._)("div",C,[(0,r.wy)((0,r._)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>O.state.trainType=e),id:"type-select"},[E,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(O.workoutTypes,(e=>((0,r.wg)(),(0,r.iD)("option",{selected:e.name===O.state.trainType,key:e.name,value:e.name},(0,n.zw)(e.description),9,H)))),128))],512),[[s.bM,O.state.trainType]])])])])):(0,r.kq)("",!0),(0,r._)("button",{onClick:t[7]||(t[7]=(...e)=>O.onClickScheduleButton&&O.onClickScheduleButton(...e)),class:(0,n.C_)(["button shedule-button",["shedule-button--"+O.buttonStyle.class,O.formIsValid&&"disabled"]]),disabled:O.formIsValid},(0,n.zw)(O.buttonStyle?O.buttonStyle.name:"Отправить"),11,K)])}var Y=a(4870),x=a(65),B=a(3053),W=a(9117),j=a(4030),P={props:{eventID:Number,eventName:String,eventType:String},setup(e){const t=(0,x.oR)(),a=(0,r.Fl)((()=>t.getters.getScheduleEvents)),n=(0,r.Fl)((()=>t.getters.getPersonalEvents)),s=(0,r.Fl)((()=>t.getters.getWorkoutTypes)),i=(0,r.Fl)((()=>t.getters.getWorkoutLocations)),l=(0,r.Fl)((()=>t.getters.getTrainers)),o=(0,r.Fl)((()=>t.getters.getTokens)),u=(0,r.Fl)((()=>t.getters.getUser)),d=(0,r.Fl)((()=>t.getters.getClients)),c=(0,Y.iH)(!1),p=(0,Y.iH)(!1),v=(0,r.Fl)((()=>e.eventID&&"group"===e.eventType?a.value.find((t=>t.id===e.eventID)):n.value.find((t=>t.id===e.eventID)))),m=(e,t)=>(new Date(t).getTime()-new Date(e).getTime())/6e4,w=(0,r.Fl)((()=>m(v.value.start,v.value.end))),g=(0,r.Fl)((()=>"create"===e.eventName?{name:"Создать тренировку",class:"add"}:"update"===e.eventName?{name:"Изменить тренировку",class:"edit"}:"delete"===e.eventName?{name:"Удалить тренировку",class:"delete"}:{name:"Отправить",class:""})),_=(0,Y.qj)({trainName:e.eventID&&v.value.title&&"update"===e.eventName?v.value.title:"",trainStart:e.eventID&&"update"===e.eventName?v.value.start:"",trainEnd:e.eventID&&"update"===e.eventName?v.value.end:"",trainLocation:e.eventID&&"update"===e.eventName?v.value.location.name:"",trainType:e.eventID&&"update"===e.eventName?v.value.type:"",trainer:e.eventID&&"update"===e.eventName?v.value.trainer.email:"",trainDuration:e.eventID&&"update"===e.eventName?w.value:0,selectUser:e.eventID&&v.value.clients&&"update"===e.eventName?v.value.clients[0]:""}),D=(0,r.Fl)((()=>_.trainStart?new Date(new Date(_.trainStart).setMinutes(new Date(_.trainStart).getMinutes()+_.trainDuration)):"")),h=e=>new Date((new Date).setDate((new Date).getDate()+7))>=new Date(e)&&new Date(e)>=new Date,y=(0,r.Fl)((()=>({trainName:{required:W.helpers.withMessage("Поле обязательно для заполнения",W.required)},trainDuration:{required:W.helpers.withMessage("Поле обязательно для заполнения",W.required),minValue:W.helpers.withMessage("Тренировка должна быть не менее 30 минут",(0,W.minValue)(30)),maxValue:W.helpers.withMessage("Тренировка должна быть не более 240 минут",(0,W.maxValue)(240))},trainStart:{required:W.helpers.withMessage("Необходимо выбрать дату!",W.required),maxDateValidator:W.helpers.withMessage("Максимально отложить дату можно на 7 дней!",h)},trainEnd:{required:W.helpers.withMessage("Необходимо выбрать дату!",W.required),maxDateValidator:W.helpers.withMessage("Максимально отложить дату можно на 7 дней!",h)},trainLocation:{required:W.helpers.withMessage("Поле обязательно для заполнения",W.required)}}))),f=(0,B.Xw)(y,_),S=()=>(f.value.$touch(),!f.value.$errors.length),k=()=>{_.trainName="",_.trainStart="",_.trainEnd="",_.trainLocation="",_.trainType="",_.trainer="",_.selectUser="",_.trainDuration=0};(0,r.wF)((()=>{"create"===e.eventName&&k()}));const b=()=>"create"===e.eventName?N():"update"===e.eventName?$():(0,j.errorNotify)("Невозможно выполнить действие"),N=()=>{if(_.trainEnd=new Date(new Date(D.value).getTime()-6e4*new Date(D.value).getTimezoneOffset()).toISOString(),_.trainStart=new Date(new Date(_.trainStart).getTime()-6e4*new Date(_.trainStart).getTimezoneOffset()).toISOString(),S()){const e={name:_.trainName,start_date:_.trainStart,end_date:_.trainEnd,gym:_.trainLocation,trainer:_.trainer,client_id:_.selectUser};return"manager"===u.value.role&&(e.workout_type=_.trainType),t.dispatch("addTrainInSchedule",{access_token:o.value.access_token,train:e,role:u.value.role}),c.value=!1,(0,j.successNotify)("Тренировка добавлена!"),k(),t.dispatch("hideScheduleEventsForm")}return(0,j.errorNotify)("Не удалось добавить тренировку")},$=()=>{if(_.trainEnd=new Date(new Date(D.value).getTime()-6e4*new Date(D.value).getTimezoneOffset()).toISOString(),_.trainStart=new Date(new Date(_.trainStart).getTime()-6e4*new Date(_.trainStart).getTimezoneOffset()).toISOString(),S()){const a={name:_.trainName,start_date:_.trainStart,end_date:_.trainEnd,workout_type:_.trainType,gym:_.trainLocation,trainer:_.trainer,selectUser:_.selectUser};return t.dispatch("editTrainInSchedule",{id:e.eventID,access_token:o.value.access_token,train:a,role:u.value.role}),c.value=!1,(0,j.successNotify)("Тренировка обновлена!"),k(),t.dispatch("hideScheduleEventsForm")}return(0,j.errorNotify)("Не удалось обновить тренировку")};return{v$:f,state:_,onClickScheduleButton:b,workoutLocations:i,workoutTypes:s,trainersList:l,endDate:D,buttonStyle:g,formIsValid:p,user:u,clients:d}}},R=a(89);const X=(0,R.Z)(P,[["render",O]]);var Z=X}}]);
//# sourceMappingURL=7181.ee8585f2.js.map